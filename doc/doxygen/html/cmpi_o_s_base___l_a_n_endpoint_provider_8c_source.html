<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>cmpi-router: /mnt/storage/cygnus/TESIS/sblim/cmpi-router/src/cmpiOSBase_LANEndpointProvider.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>/mnt/storage/cygnus/TESIS/sblim/cmpi-router/src/cmpiOSBase_LANEndpointProvider.c</h1><a href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;cmpidt.h&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;cmpift.h&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;cmpimacs.h&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;OSBase_Common.h&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;cmpiOSBase_Common.h&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html">cmpiOSBase_LANEndpoint.h</a>&quot;</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00041"></a><a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">00041</a> <span class="keyword">static</span> <span class="keyword">const</span> CMPIBroker *<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>;
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#ifdef CMPI_VER_100</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span><span class="preprocessor">#define OSBase_LANEndpointProviderSetInstance OSBase_LANEndpointProviderModifyInstance</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span><span class="preprocessor">#endif //CMPI_VER_100</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span><span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 
<a name="l00050"></a>00050 <span class="comment">// INSTANCE PROVIDER INTERFACE</span>
<a name="l00052"></a>00052 <span class="comment"></span>
<a name="l00053"></a>00053 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00054"></a><a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a37fa7459a54076c6e52996053eff6d05">00054</a> CMPIStatus <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a37fa7459a54076c6e52996053eff6d05">OSBase_LANEndpointProviderCleanup</a>(CMPIInstanceMI *mi,
<a name="l00055"></a>00055                                              <span class="keyword">const</span> CMPIContext *ctx,
<a name="l00056"></a>00056                                              CMPIBoolean terminating)
<a name="l00057"></a>00057 {
<a name="l00058"></a>00058     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI Cleanup() called&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00059"></a>00059 
<a name="l00060"></a>00060     CMReturn(CMPI_RC_OK);
<a name="l00061"></a>00061 
<a name="l00062"></a>00062     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI Cleanup() exited&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00063"></a>00063 }
<a name="l00064"></a>00064 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00067"></a><a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#aa8e18ac30a9b6c6f67e1a0a134a138d5">00067</a> CMPIStatus <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#aa8e18ac30a9b6c6f67e1a0a134a138d5">OSBase_LANEndpointProviderEnumInstanceNames</a>(CMPIInstanceMI *mi,
<a name="l00068"></a>00068                                                        <span class="keyword">const</span> CMPIContext *ctx,
<a name="l00069"></a>00069                                                        <span class="keyword">const</span> CMPIResult *rslt,
<a name="l00070"></a>00070                                                        <span class="keyword">const</span> CMPIObjectPath *ref)
<a name="l00071"></a>00071 {
<a name="l00072"></a>00072     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI EnumInstanceNames() called&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00073"></a>00073 
<a name="l00074"></a>00074     CMPIObjectPath         *op    = NULL;               <span class="comment">// Object path instance.</span>
<a name="l00075"></a>00075     <span class="keyword">struct </span><a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> *list  = NULL;               <span class="comment">// LANEndpoint list.</span>
<a name="l00076"></a>00076     <span class="keyword">struct </span><a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> *lptr  = NULL;               <span class="comment">// Current position in</span>
<a name="l00077"></a>00077                                                         <span class="comment">// the list.</span>
<a name="l00078"></a>00078     CMPIStatus              rc    = {CMPI_RC_OK, NULL}; <span class="comment">// Return status of</span>
<a name="l00079"></a>00079                                                         <span class="comment">// CIM operations.</span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081     <span class="comment">// Get links.</span>
<a name="l00082"></a>00082     <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a912c0a67e9c08a00c9c4af12c5d9fe4c">getALLLANEndpoints</a>(&amp;list) != <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>) {
<a name="l00083"></a>00083         CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_FAILED,
<a name="l00084"></a>00084                              <span class="stringliteral">&quot;Could not list LANEndpoints.&quot;</span>);
<a name="l00085"></a>00085         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI EnumInstanceNames() failed: %s&quot;</span>,
<a name="l00086"></a>00086                           <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, CMGetCharPtr(rc.msg)));
<a name="l00087"></a>00087         <span class="keywordflow">goto</span> out;
<a name="l00088"></a>00088     }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090     <span class="comment">// Put pointer to the begining of the list.</span>
<a name="l00091"></a>00091     lptr = list;
<a name="l00092"></a>00092 
<a name="l00093"></a>00093     <span class="comment">// Iterate routes list.</span>
<a name="l00094"></a>00094     <span class="keywordflow">while</span>(lptr != NULL &amp;&amp; rc.rc == CMPI_RC_OK) {
<a name="l00095"></a>00095         <span class="keywordflow">if</span>(lptr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a> != NULL) {
<a name="l00096"></a>00096             op = <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#ae5f3d2d4919eb540a7d4f673584d4039">_makePath_LANEndpoint</a>(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, ctx, ref, lptr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a>, &amp;rc);
<a name="l00097"></a>00097             <span class="keywordflow">if</span>((op == NULL) || (rc.rc != CMPI_RC_OK)) {
<a name="l00098"></a>00098                 <span class="keywordflow">if</span>(rc.msg != NULL) {
<a name="l00099"></a>00099                     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI EnumInstanceNames() &quot;</span> \
<a name="l00100"></a>00100                                       <span class="stringliteral">&quot;failed: %s&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>,
<a name="l00101"></a>00101                                       CMGetCharPtr(rc.msg)));
<a name="l00102"></a>00102                 }
<a name="l00103"></a>00103                 CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_FAILED,
<a name="l00104"></a>00104                                      <span class="stringliteral">&quot;Transformation from internal structure &quot;</span> \
<a name="l00105"></a>00105                                      <span class="stringliteral">&quot;to CIM Instance failed.&quot;</span>);
<a name="l00106"></a>00106                 _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI EnumInstanceNames() failed: %s&quot;</span>,
<a name="l00107"></a>00107                                   <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, CMGetCharPtr(rc.msg)));
<a name="l00108"></a>00108                 <span class="keywordflow">goto</span> out;
<a name="l00109"></a>00109             } <span class="keywordflow">else</span> {
<a name="l00110"></a>00110                 CMReturnObjectPath(rslt, op);
<a name="l00111"></a>00111             }
<a name="l00112"></a>00112         }
<a name="l00113"></a>00113         lptr = lptr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#a73dddd0fd4134de1e21beaba4329d0ac">next</a>;
<a name="l00114"></a>00114     }
<a name="l00115"></a>00115 
<a name="l00116"></a>00116  out:
<a name="l00117"></a>00117     <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0ff3f1739478cd89305b5dbb5240aaad">freeLANEndpointList</a>(lptr);
<a name="l00118"></a>00118     <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0ff3f1739478cd89305b5dbb5240aaad">freeLANEndpointList</a>(list);
<a name="l00119"></a>00119     CMReturnDone(rslt);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI EnumInstanceNames() exited&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00122"></a>00122     <span class="keywordflow">return</span> rc;
<a name="l00123"></a>00123 }
<a name="l00124"></a>00124 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00127"></a><a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a5fd8e199444f059da886b9f862c5b794">00127</a> CMPIStatus <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a5fd8e199444f059da886b9f862c5b794">OSBase_LANEndpointProviderEnumInstances</a>(CMPIInstanceMI *mi,
<a name="l00128"></a>00128                                                    <span class="keyword">const</span> CMPIContext *ctx,
<a name="l00129"></a>00129                                                    <span class="keyword">const</span> CMPIResult *rslt,
<a name="l00130"></a>00130                                                    <span class="keyword">const</span> CMPIObjectPath *ref,
<a name="l00131"></a>00131                                                    <span class="keyword">const</span> <span class="keywordtype">char</span> **properties)
<a name="l00132"></a>00132 {
<a name="l00133"></a>00133     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI EnumInstances() called&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     CMPIInstance           *ci    = NULL;               <span class="comment">// Class instance.</span>
<a name="l00136"></a>00136     <span class="keyword">struct </span><a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> *list  = NULL;               <span class="comment">// LANEndpoint list.</span>
<a name="l00137"></a>00137     <span class="keyword">struct </span><a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> *lptr  = NULL;               <span class="comment">// Current position in</span>
<a name="l00138"></a>00138                                                         <span class="comment">// the list.</span>
<a name="l00139"></a>00139     CMPIStatus              rc    = {CMPI_RC_OK, NULL}; <span class="comment">// Return status of</span>
<a name="l00140"></a>00140                                                         <span class="comment">// CIM operations.</span>
<a name="l00141"></a>00141 
<a name="l00142"></a>00142     <span class="comment">// Get links.</span>
<a name="l00143"></a>00143     <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a912c0a67e9c08a00c9c4af12c5d9fe4c">getALLLANEndpoints</a>(&amp;list) != <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>) {
<a name="l00144"></a>00144         CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_FAILED,
<a name="l00145"></a>00145                              <span class="stringliteral">&quot;Could not list LANEndpoints.&quot;</span>);
<a name="l00146"></a>00146         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI EnumInstances() failed: %s&quot;</span>,
<a name="l00147"></a>00147                           <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, CMGetCharPtr(rc.msg)));
<a name="l00148"></a>00148         <span class="keywordflow">goto</span> out;
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150 
<a name="l00151"></a>00151     <span class="comment">// Put pointer to the begining of the list.</span>
<a name="l00152"></a>00152     lptr = list;
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     <span class="comment">// Iterate routes list.</span>
<a name="l00155"></a>00155     <span class="keywordflow">while</span>(lptr != NULL &amp;&amp; rc.rc == CMPI_RC_OK) {
<a name="l00156"></a>00156         <span class="keywordflow">if</span>(lptr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a> != NULL) {
<a name="l00157"></a>00157             ci = <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af657b2d667cbd02cc249ba45ad324cd6">_makeInst_LANEndpoint</a>(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, ctx, ref, properties,
<a name="l00158"></a>00158                                        lptr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a>, &amp;rc);
<a name="l00159"></a>00159             <span class="keywordflow">if</span>((ci == NULL) || (rc.rc != CMPI_RC_OK)) {
<a name="l00160"></a>00160                 <span class="keywordflow">if</span>(rc.msg != NULL) {
<a name="l00161"></a>00161                     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI EnumInstances() failed: %s&quot;</span>,
<a name="l00162"></a>00162                                       <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, CMGetCharPtr(rc.msg)));
<a name="l00163"></a>00163                 }
<a name="l00164"></a>00164                 CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_FAILED,
<a name="l00165"></a>00165                                      <span class="stringliteral">&quot;Transformation from internal structure &quot;</span> \
<a name="l00166"></a>00166                                      <span class="stringliteral">&quot;to CIM Instance failed.&quot;</span>);
<a name="l00167"></a>00167                 _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI EnumInstances() failed: %s&quot;</span>,
<a name="l00168"></a>00168                                   <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, CMGetCharPtr(rc.msg)));
<a name="l00169"></a>00169                 <span class="keywordflow">goto</span> out;
<a name="l00170"></a>00170             } <span class="keywordflow">else</span> {
<a name="l00171"></a>00171                 CMReturnInstance(rslt, ci);
<a name="l00172"></a>00172             }
<a name="l00173"></a>00173         }
<a name="l00174"></a>00174         lptr = lptr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#a73dddd0fd4134de1e21beaba4329d0ac">next</a>;
<a name="l00175"></a>00175     }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177  out:
<a name="l00178"></a>00178     <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0ff3f1739478cd89305b5dbb5240aaad">freeLANEndpointList</a>(lptr);
<a name="l00179"></a>00179     <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0ff3f1739478cd89305b5dbb5240aaad">freeLANEndpointList</a>(list);
<a name="l00180"></a>00180     CMReturnDone(rslt);
<a name="l00181"></a>00181 
<a name="l00182"></a>00182     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI EnumInstances() exited&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00183"></a>00183     <span class="keywordflow">return</span> rc;
<a name="l00184"></a>00184 }
<a name="l00185"></a>00185 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00186"></a>00186 
<a name="l00187"></a>00187 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00188"></a><a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#aed9a058bc27985d195a52e53b8ff8eab">00188</a> CMPIStatus <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#aed9a058bc27985d195a52e53b8ff8eab">OSBase_LANEndpointProviderGetInstance</a>(CMPIInstanceMI *mi,
<a name="l00189"></a>00189                                                  <span class="keyword">const</span> CMPIContext *ctx,
<a name="l00190"></a>00190                                                  <span class="keyword">const</span> CMPIResult *rslt,
<a name="l00191"></a>00191                                                  <span class="keyword">const</span> CMPIObjectPath *cop,
<a name="l00192"></a>00192                                                  <span class="keyword">const</span> <span class="keywordtype">char</span> **properties)
<a name="l00193"></a>00193 {
<a name="l00194"></a>00194     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI GetInstance() called&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00195"></a>00195 
<a name="l00196"></a>00196     CMPIInstance           *ci    = NULL;               <span class="comment">// Class instance.</span>
<a name="l00197"></a>00197     CMPIData                data;                       <span class="comment">// CIM datum to extract</span>
<a name="l00198"></a>00198                                                         <span class="comment">// property values.</span>
<a name="l00199"></a>00199     <span class="keyword">struct </span><a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> *list  = NULL;               <span class="comment">// LANEndpoint list.</span>
<a name="l00200"></a>00200     CMPIStatus              rc    = {CMPI_RC_OK, NULL}; <span class="comment">// Return status of</span>
<a name="l00201"></a>00201                                                         <span class="comment">// CIM operations.</span>
<a name="l00202"></a>00202 
<a name="l00203"></a>00203     <span class="comment">// Get Name.</span>
<a name="l00204"></a>00204     data = CMGetKey(cop, <span class="stringliteral">&quot;Name&quot;</span>, &amp;rc);
<a name="l00205"></a>00205     <span class="keywordflow">if</span>((rc.rc != CMPI_RC_OK) || (CMIsNullValue(data)) ||
<a name="l00206"></a>00206         (data.type != CMPI_string)) {
<a name="l00207"></a>00207         CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_NO_SUCH_PROPERTY,
<a name="l00208"></a>00208                              <span class="stringliteral">&quot;Could not get LANEndpoint Name.&quot;</span>);
<a name="l00209"></a>00209         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI GetInstance() failed: %s&quot;</span>,
<a name="l00210"></a>00210                           <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, CMGetCharPtr(rc.msg)));
<a name="l00211"></a>00211         <span class="keywordflow">goto</span> out;
<a name="l00212"></a>00212     }
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     <span class="comment">// Get link info.</span>
<a name="l00215"></a>00215     <span class="keywordflow">if</span>((<a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0e24fae564ca4e06b1a7e8ce7c246ce5">getLANEndpoint</a>(&amp;list, CMGetCharPtr(data.value.string)) != <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>) ||
<a name="l00216"></a>00216        (list == NULL)) {
<a name="l00217"></a>00217         CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_NOT_FOUND,
<a name="l00218"></a>00218                              <span class="stringliteral">&quot;LANEndpoint does not exist.&quot;</span>);
<a name="l00219"></a>00219         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI GetInstance() failed: %s&quot;</span>,
<a name="l00220"></a>00220                           <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, CMGetCharPtr(rc.msg)));
<a name="l00221"></a>00221         <span class="keywordflow">goto</span> out;
<a name="l00222"></a>00222     }
<a name="l00223"></a>00223 
<a name="l00224"></a>00224     <span class="comment">// Create new instance.</span>
<a name="l00225"></a>00225     ci = <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af657b2d667cbd02cc249ba45ad324cd6">_makeInst_LANEndpoint</a>(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, ctx, cop, properties,
<a name="l00226"></a>00226                                list-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a>, &amp;rc);
<a name="l00227"></a>00227     <span class="keywordflow">if</span>(ci == NULL) {
<a name="l00228"></a>00228         <span class="keywordflow">if</span>(rc.msg != NULL) {
<a name="l00229"></a>00229             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI GetInstance() failed: %s&quot;</span>,
<a name="l00230"></a>00230                               <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, CMGetCharPtr(rc.msg)));
<a name="l00231"></a>00231         } <span class="keywordflow">else</span> {
<a name="l00232"></a>00232             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI GetInstance() failed&quot;</span>,
<a name="l00233"></a>00233                               <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00234"></a>00234         }
<a name="l00235"></a>00235         <span class="keywordflow">goto</span> out;
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237     CMReturnInstance(rslt, ci);
<a name="l00238"></a>00238 
<a name="l00239"></a>00239  out:
<a name="l00240"></a>00240     <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0ff3f1739478cd89305b5dbb5240aaad">freeLANEndpointList</a>(list);
<a name="l00241"></a>00241     CMReturnDone(rslt);
<a name="l00242"></a>00242 
<a name="l00243"></a>00243     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI GetInstance() exited&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00244"></a>00244     <span class="keywordflow">return</span> rc;
<a name="l00245"></a>00245 }
<a name="l00246"></a>00246 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00249"></a><a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#acbb698e57705578299f8ae72770d809e">00249</a> CMPIStatus <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#acbb698e57705578299f8ae72770d809e">OSBase_LANEndpointProviderCreateInstance</a>(CMPIInstanceMI *mi,
<a name="l00250"></a>00250                                                     <span class="keyword">const</span> CMPIContext *ctx,
<a name="l00251"></a>00251                                                     <span class="keyword">const</span> CMPIResult *rslt,
<a name="l00252"></a>00252                                                     <span class="keyword">const</span> CMPIObjectPath *cop,
<a name="l00253"></a>00253                                                     <span class="keyword">const</span> CMPIInstance *ci)
<a name="l00254"></a>00254 {
<a name="l00255"></a>00255     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI CreateInstance() called&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     CMPIStatus rc = {CMPI_RC_OK, NULL}; <span class="comment">// Return status of CIM operations.</span>
<a name="l00258"></a>00258 
<a name="l00259"></a>00259     CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_NOT_SUPPORTED,
<a name="l00260"></a>00260                          <span class="stringliteral">&quot;CIM_ERR_NOT_SUPPORTED&quot;</span>);
<a name="l00261"></a>00261     CMReturnDone(rslt);
<a name="l00262"></a>00262 
<a name="l00263"></a>00263     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI CreateInstance() exited&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00264"></a>00264     <span class="keywordflow">return</span> rc;
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00269"></a><a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a8d6ada0d3a2d0a90ed2d2bb6596c9e64">00269</a> CMPIStatus <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a8d6ada0d3a2d0a90ed2d2bb6596c9e64">OSBase_LANEndpointProviderSetInstance</a>(CMPIInstanceMI *mi,
<a name="l00270"></a>00270                                                  <span class="keyword">const</span> CMPIContext *ctx,
<a name="l00271"></a>00271                                                  <span class="keyword">const</span> CMPIResult *rslt,
<a name="l00272"></a>00272                                                  <span class="keyword">const</span> CMPIObjectPath *cop,
<a name="l00273"></a>00273                                                  <span class="keyword">const</span> CMPIInstance *ci,
<a name="l00274"></a>00274                                                  <span class="keyword">const</span> <span class="keywordtype">char</span> **properties)
<a name="l00275"></a>00275 {
<a name="l00276"></a>00276     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI SetInstance() called&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00277"></a>00277 
<a name="l00278"></a>00278     CMPIStatus rc = {CMPI_RC_OK, NULL}; <span class="comment">// Return status of CIM operations.</span>
<a name="l00279"></a>00279 
<a name="l00280"></a>00280     CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_NOT_SUPPORTED,
<a name="l00281"></a>00281                          <span class="stringliteral">&quot;CIM_ERR_NOT_SUPPORTED&quot;</span>);
<a name="l00282"></a>00282     CMReturnDone(rslt);
<a name="l00283"></a>00283 
<a name="l00284"></a>00284     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI SetInstance() exited&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00285"></a>00285     <span class="keywordflow">return</span> rc;
<a name="l00286"></a>00286 }
<a name="l00287"></a>00287 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00290"></a><a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a6716add70301e0db413110445a6594f6">00290</a> CMPIStatus <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a6716add70301e0db413110445a6594f6">OSBase_LANEndpointProviderDeleteInstance</a>(CMPIInstanceMI *mi,
<a name="l00291"></a>00291                                                     <span class="keyword">const</span> CMPIContext *ctx,
<a name="l00292"></a>00292                                                     <span class="keyword">const</span> CMPIResult *rslt,
<a name="l00293"></a>00293                                                     <span class="keyword">const</span> CMPIObjectPath *cop)
<a name="l00294"></a>00294 {
<a name="l00295"></a>00295     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI DeleteInstance() called&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00296"></a>00296 
<a name="l00297"></a>00297     CMPIStatus rc = {CMPI_RC_OK, NULL}; <span class="comment">// Return status of CIM operations.</span>
<a name="l00298"></a>00298 
<a name="l00299"></a>00299     CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_NOT_SUPPORTED,
<a name="l00300"></a>00300                          <span class="stringliteral">&quot;CIM_ERR_NOT_SUPPORTED&quot;</span>);
<a name="l00301"></a>00301     CMReturnDone(rslt);
<a name="l00302"></a>00302 
<a name="l00303"></a>00303     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI DeleteInstance() exited&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00304"></a>00304     <span class="keywordflow">return</span> rc;
<a name="l00305"></a>00305 }
<a name="l00306"></a>00306 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00309"></a><a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a34e4301faf2db86b2596ad8d9e236eb6">00309</a> CMPIStatus <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a34e4301faf2db86b2596ad8d9e236eb6">OSBase_LANEndpointProviderExecQuery</a>(CMPIInstanceMI *mi,
<a name="l00310"></a>00310                                                <span class="keyword">const</span> CMPIContext *ctx,
<a name="l00311"></a>00311                                                <span class="keyword">const</span> CMPIResult *rslt,
<a name="l00312"></a>00312                                                <span class="keyword">const</span> CMPIObjectPath *ref,
<a name="l00313"></a>00313                                                <span class="keyword">const</span> <span class="keywordtype">char</span> *lang,
<a name="l00314"></a>00314                                                <span class="keyword">const</span> <span class="keywordtype">char</span> *query)
<a name="l00315"></a>00315 {
<a name="l00316"></a>00316     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI ExecQuery() called&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00317"></a>00317 
<a name="l00318"></a>00318     CMPIStatus rc = {CMPI_RC_OK, NULL}; <span class="comment">// Return status of CIM operations.</span>
<a name="l00319"></a>00319 
<a name="l00320"></a>00320     CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_NOT_SUPPORTED,
<a name="l00321"></a>00321                          <span class="stringliteral">&quot;CIM_ERR_NOT_SUPPORTED&quot;</span>);
<a name="l00322"></a>00322     CMReturnDone(rslt);
<a name="l00323"></a>00323 
<a name="l00324"></a>00324     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI ExecQuery() exited&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00325"></a>00325     <span class="keywordflow">return</span> rc;
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00328"></a>00328 
<a name="l00330"></a>00330 
<a name="l00331"></a>00331 
<a name="l00333"></a>00333 <span class="comment">// METHOD PROVIDER INTERFACE</span>
<a name="l00335"></a>00335 <span class="comment"></span>
<a name="l00336"></a>00336 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00337"></a><a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#ac6c0cd206e40bf1924c578935fd4ab7d">00337</a> CMPIStatus <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#ac6c0cd206e40bf1924c578935fd4ab7d">OSBase_LANEndpointProviderMethodCleanup</a>(CMPIMethodMI *mi,
<a name="l00338"></a>00338                                                    <span class="keyword">const</span> CMPIContext *ctx,
<a name="l00339"></a>00339                                                    CMPIBoolean terminating)
<a name="l00340"></a>00340 {
<a name="l00341"></a>00341     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI MethodCleanup() called&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00342"></a>00342 
<a name="l00343"></a>00343     CMReturn(CMPI_RC_OK);
<a name="l00344"></a>00344 
<a name="l00345"></a>00345     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI MethodCleanup() exited&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00346"></a>00346 }
<a name="l00347"></a>00347 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00348"></a>00348 
<a name="l00349"></a>00349 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00350"></a><a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a2251c67eecbbf3c7c3f5847e2984dd90">00350</a> CMPIStatus <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a2251c67eecbbf3c7c3f5847e2984dd90">OSBase_LANEndpointProviderInvokeMethod</a>(CMPIMethodMI *mi,
<a name="l00351"></a>00351                                                   <span class="keyword">const</span> CMPIContext *ctx,
<a name="l00352"></a>00352                                                   <span class="keyword">const</span> CMPIResult *rslt,
<a name="l00353"></a>00353                                                   <span class="keyword">const</span> CMPIObjectPath *ref,
<a name="l00354"></a>00354                                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *methodName,
<a name="l00355"></a>00355                                                   <span class="keyword">const</span> CMPIArgs *in,
<a name="l00356"></a>00356                                                   CMPIArgs *out)
<a name="l00357"></a>00357 {
<a name="l00358"></a>00358     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI InvokeMethod() called&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00359"></a>00359 
<a name="l00360"></a>00360     CMPIString *<span class="keyword">class </span>= NULL;               <span class="comment">// Class name.</span>
<a name="l00361"></a>00361     CMPIStatus  rc    = {CMPI_RC_OK, NULL}; <span class="comment">// Return status of CIM operations.</span>
<a name="l00362"></a>00362 
<a name="l00363"></a>00363     <span class="comment">// Obtain class name.</span>
<a name="l00364"></a>00364     <span class="keyword">class </span>= CMGetClassName(ref, &amp;rc);
<a name="l00365"></a>00365 
<a name="l00366"></a>00366     <span class="comment">// RequestStateChange</span>
<a name="l00367"></a>00367     <span class="keywordflow">if</span>((strcasecmp(CMGetCharPtr(<span class="keyword">class</span>), <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>) == 0) &amp;&amp;
<a name="l00368"></a>00368        (strcasecmp(<span class="stringliteral">&quot;RequestStateChange&quot;</span>, methodName) == 0)) {
<a name="l00369"></a>00369         CMPIInstance *instance     = NULL;       <span class="comment">// Target device instance.</span>
<a name="l00370"></a>00370         CMPIData      data;                      <span class="comment">// CIM datum to extract</span>
<a name="l00371"></a>00371                                                  <span class="comment">// property values.</span>
<a name="l00372"></a>00372         CMPIString   *name         = NULL;       <span class="comment">// LANEndpoint Name.</span>
<a name="l00373"></a>00373         CMPIUint16    enabledState;              <span class="comment">// Indicates the enabled and</span>
<a name="l00374"></a>00374                                                  <span class="comment">// disabled states of the</span>
<a name="l00375"></a>00375                                                  <span class="comment">// device.</span>
<a name="l00376"></a>00376         CMPIString   *otherEnSt    = NULL;       <span class="comment">// A string that describes the</span>
<a name="l00377"></a>00377                                                  <span class="comment">// enabled or disabled state</span>
<a name="l00378"></a>00378                                                  <span class="comment">// of the element when the</span>
<a name="l00379"></a>00379                                                  <span class="comment">// EnabledState property is</span>
<a name="l00380"></a>00380                                                  <span class="comment">// set to 1.</span>
<a name="l00381"></a>00381         CMPIUint16    reqState;                  <span class="comment">// Desired state for the</span>
<a name="l00382"></a>00382                                                  <span class="comment">// device.</span>
<a name="l00383"></a>00383         CMPIString   *timeoutP     = NULL;       <span class="comment">// A timeout period that</span>
<a name="l00384"></a>00384                                                  <span class="comment">// specifies the maximum</span>
<a name="l00385"></a>00385                                                  <span class="comment">// amount of time that the</span>
<a name="l00386"></a>00386                                                  <span class="comment">// client expects the</span>
<a name="l00387"></a>00387                                                  <span class="comment">// transition to the new state</span>
<a name="l00388"></a>00388                                                  <span class="comment">// to take. (must be a</span>
<a name="l00389"></a>00389                                                  <span class="comment">// datetime interval -&gt;</span>
<a name="l00390"></a>00390                                                  <span class="comment">// ddddddddhhmmss.mmmmmm:000).</span>
<a name="l00391"></a>00391         CMPIBoolean   skipTimeoutP = CMPI_false; <span class="comment">// If TimeoutPeriod is NULL or</span>
<a name="l00392"></a>00392                                                  <span class="comment">// 0, indicates that the</span>
<a name="l00393"></a>00393                                                  <span class="comment">// client has no time</span>
<a name="l00394"></a>00394                                                  <span class="comment">// requirements for the</span>
<a name="l00395"></a>00395                                                  <span class="comment">// transition.</span>
<a name="l00396"></a>00396         CMPIDateTime *timeLtStCh   = NULL;       <span class="comment">// The date or time when the</span>
<a name="l00397"></a>00397                                                  <span class="comment">// EnabledState of the element</span>
<a name="l00398"></a>00398                                                  <span class="comment">// last changed.</span>
<a name="l00399"></a>00399         CMPIUint16    result;                    <span class="comment">// Result of state change.</span>
<a name="l00400"></a>00400         <span class="keywordtype">char</span>          resError[256];             <span class="comment">// Result error description.</span>
<a name="l00401"></a>00401         
<a name="l00402"></a>00402         <span class="comment">// Get the LANEndpoint name from the reference object path.</span>
<a name="l00403"></a>00403         data = CMGetKey(ref, <span class="stringliteral">&quot;Name&quot;</span>, &amp;rc);
<a name="l00404"></a>00404         <span class="keywordflow">if</span>((rc.rc == CMPI_RC_OK) &amp;&amp; !CMIsNullValue(data)) {
<a name="l00405"></a>00405             name = data.value.string;
<a name="l00406"></a>00406         }
<a name="l00407"></a>00407         <span class="keywordflow">if</span>(name == NULL) {
<a name="l00408"></a>00408             CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_NOT_FOUND,
<a name="l00409"></a>00409                                  <span class="stringliteral">&quot;Cannot determine Name&quot;</span>);
<a name="l00410"></a>00410             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;%s CMPI InvokeMethod() [%s] failed: %s&quot;</span>,
<a name="l00411"></a>00411                               <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, methodName, CMGetCharPtr(rc.msg)));
<a name="l00412"></a>00412             <span class="keywordflow">goto</span> out;
<a name="l00413"></a>00413         }
<a name="l00414"></a>00414 
<a name="l00415"></a>00415         <span class="comment">// Get the requested state from the input args.</span>
<a name="l00416"></a>00416         data = CMGetArg(in, <span class="stringliteral">&quot;RequestedState&quot;</span>, &amp;rc);
<a name="l00417"></a>00417         <span class="keywordflow">if</span>((rc.rc == CMPI_RC_OK) &amp;&amp; !CMIsNullValue(data)) {
<a name="l00418"></a>00418             <span class="keywordflow">if</span>(data.type == CMPI_uint16) {
<a name="l00419"></a>00419                 reqState = data.value.uint16;
<a name="l00420"></a>00420             } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(data.type == CMPI_string) {
<a name="l00421"></a>00421                 reqState = (CMPIUint16)atoi(CMGetCharPtr(data.value.string));
<a name="l00422"></a>00422             }
<a name="l00423"></a>00423         }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425         <span class="comment">// Get the timeout period from the input args.</span>
<a name="l00426"></a>00426         data = CMGetArg(in, <span class="stringliteral">&quot;TimeoutPeriod&quot;</span>, &amp;rc);
<a name="l00427"></a>00427         <span class="keywordflow">if</span>(rc.rc == CMPI_RC_OK) {
<a name="l00428"></a>00428             <span class="keywordflow">if</span>(!CMIsNullValue(data)) {
<a name="l00429"></a>00429                 <span class="keywordflow">if</span>(data.type == CMPI_dateTime) {
<a name="l00430"></a>00430                     <span class="comment">// TimeoutPeriod must be datetime interval.</span>
<a name="l00431"></a>00431                     <span class="keywordflow">if</span>(!CMIsInterval(data.value.dateTime, &amp;rc)) {
<a name="l00432"></a>00432                         CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc,
<a name="l00433"></a>00433                                              CMPI_RC_ERR_INVALID_PARAMETER,
<a name="l00434"></a>00434                                              <span class="stringliteral">&quot;TimeoutPeriod must be datetime &quot;</span> \
<a name="l00435"></a>00435                                              <span class="stringliteral">&quot;interval. &quot;</span>               \
<a name="l00436"></a>00436                                              <span class="stringliteral">&quot;(ddddddddhhmmss.mmmmmm:000)&quot;</span>);
<a name="l00437"></a>00437                         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;%s CMPI InvokeMethod() [%s] &quot;</span> \
<a name="l00438"></a>00438                                           <span class="stringliteral">&quot;failed: %s&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, methodName,
<a name="l00439"></a>00439                                           CMGetCharPtr(rc.msg)));
<a name="l00440"></a>00440                         <span class="keywordflow">goto</span> out;
<a name="l00441"></a>00441                     } <span class="keywordflow">else</span> {
<a name="l00442"></a>00442                         timeoutP = CMGetStringFormat(data.value.dateTime, &amp;rc);
<a name="l00443"></a>00443                     }
<a name="l00444"></a>00444                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(data.type == CMPI_string) {
<a name="l00445"></a>00445                     timeoutP = data.value.string;
<a name="l00446"></a>00446                 }
<a name="l00447"></a>00447             } <span class="keywordflow">else</span> {
<a name="l00448"></a>00448                 skipTimeoutP = CMPI_true;
<a name="l00449"></a>00449             }
<a name="l00450"></a>00450         }
<a name="l00451"></a>00451         <span class="keywordflow">if</span>(!skipTimeoutP &amp;&amp; timeoutP == NULL) {
<a name="l00452"></a>00452             CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_NO_SUCH_PROPERTY,
<a name="l00453"></a>00453                                  <span class="stringliteral">&quot;Cannot determine TimeoutPeriod&quot;</span>);
<a name="l00454"></a>00454             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;%s CMPI InvokeMethod() [%s] failed: %s&quot;</span>,
<a name="l00455"></a>00455                               <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, methodName, CMGetCharPtr(rc.msg)));
<a name="l00456"></a>00456             <span class="keywordflow">goto</span> out;
<a name="l00457"></a>00457         }
<a name="l00458"></a>00458 
<a name="l00459"></a>00459         <span class="comment">// Getting instance from the specified Device.</span>
<a name="l00460"></a>00460         instance = CBGetInstance(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, ctx, ref, NULL, &amp;rc);
<a name="l00461"></a>00461         <span class="keywordflow">if</span>((rc.rc != CMPI_RC_OK) &amp;&amp; CMIsNullObject(instance)) {
<a name="l00462"></a>00462             CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_FAILED,
<a name="l00463"></a>00463                                  <span class="stringliteral">&quot;Cannot get the instance from the specified&quot;</span>
<a name="l00464"></a>00464                                  <span class="stringliteral">&quot;Device&quot;</span>);
<a name="l00465"></a>00465             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;%s CMPI InvokeMethod() [%s] failed: %s&quot;</span>,
<a name="l00466"></a>00466                               <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, methodName, CMGetCharPtr(rc.msg)));
<a name="l00467"></a>00467             <span class="keywordflow">goto</span> out;
<a name="l00468"></a>00468         }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470         <span class="comment">// Setting RequestedState.</span>
<a name="l00471"></a>00471         CMSetProperty(instance, <span class="stringliteral">&quot;RequestedState&quot;</span>,
<a name="l00472"></a>00472                       (CMPIValue*)&amp;(reqState), CMPI_uint16);
<a name="l00473"></a>00473 
<a name="l00474"></a>00474         <span class="comment">// Setting EnabledState.</span>
<a name="l00475"></a>00475         enabledState = reqState;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477         <span class="comment">// Change link Operational status.</span>
<a name="l00478"></a>00478         <span class="keywordflow">if</span>(!skipTimeoutP) {
<a name="l00479"></a>00479             CMPIUint64 convertedDateTime =
<a name="l00480"></a>00480                 <a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a4516f8c4ceb2bb917acb8e3e4e5cedb9">datetime_str_interval_to_ms</a>(CMGetCharPtr(timeoutP));
<a name="l00481"></a>00481             result = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab96e1416278e303b6eeb6fe2feb0af82">changeLinkOPState</a>(CMGetCharPtr(name),
<a name="l00482"></a>00482                                         enabledState, convertedDateTime);
<a name="l00483"></a>00483         } <span class="keywordflow">else</span> {
<a name="l00484"></a>00484             result = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab96e1416278e303b6eeb6fe2feb0af82">changeLinkOPState</a>(CMGetCharPtr(name),
<a name="l00485"></a>00485                                         enabledState, 0);
<a name="l00486"></a>00486         }
<a name="l00487"></a>00487         <span class="keywordflow">if</span>(result != 0) {
<a name="l00488"></a>00488             snprintf(resError, 256, <span class="stringliteral">&quot;Result code %d&quot;</span>, result);
<a name="l00489"></a>00489             CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERROR, resError);
<a name="l00490"></a>00490             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;%s CMPI InvokeMethod() [%s] failed: %s&quot;</span>,
<a name="l00491"></a>00491                               <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, methodName, CMGetCharPtr(rc.msg)));
<a name="l00492"></a>00492             <span class="keywordflow">goto</span> out;
<a name="l00493"></a>00493         }
<a name="l00494"></a>00494         CMSetProperty(instance, <span class="stringliteral">&quot;EnabledState&quot;</span>,
<a name="l00495"></a>00495                       (CMPIValue*)&amp;(enabledState), CMPI_uint16);
<a name="l00496"></a>00496 
<a name="l00497"></a>00497         <span class="comment">// Setting TimeOfLastStateChange.</span>
<a name="l00498"></a>00498         timeLtStCh = CMNewDateTime(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc);
<a name="l00499"></a>00499         CMSetProperty(instance, <span class="stringliteral">&quot;TimeOfLastStateChange&quot;</span>,
<a name="l00500"></a>00500                       (CMPIValue*)&amp;(timeLtStCh), CMPI_dateTime);
<a name="l00501"></a>00501         
<a name="l00502"></a>00502     out:
<a name="l00503"></a>00503         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;%s CMPI InvokeMethod() [%s] failed: %s&quot;</span>,
<a name="l00504"></a>00504                           <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>, methodName,
<a name="l00505"></a>00505                           (rc.rc == CMPI_RC_OK)?<span class="stringliteral">&quot;succeeded&quot;</span>:<span class="stringliteral">&quot;failed&quot;</span>));
<a name="l00506"></a>00506     } <span class="keywordflow">else</span> {
<a name="l00507"></a>00507         CMSetStatusWithChars(<a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>, &amp;rc, CMPI_RC_ERR_NOT_FOUND,
<a name="l00508"></a>00508                              methodName);
<a name="l00509"></a>00509     }
<a name="l00510"></a>00510     CMReturnDone(rslt);
<a name="l00511"></a>00511 
<a name="l00512"></a>00512     _OSBASE_TRACE(1, (<span class="stringliteral">&quot;--- %s CMPI InvokeMethod() exited&quot;</span>, <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_8h.html#af2a15829b64ca3acb0e5b158763519f4">_ClassName</a>));
<a name="l00513"></a>00513     <span class="keywordflow">return</span> rc;
<a name="l00514"></a>00514 }
<a name="l00515"></a>00515 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00516"></a>00516 
<a name="l00518"></a>00518 
<a name="l00519"></a>00519 
<a name="l00521"></a>00521 <span class="comment">// PROVIDER FACTORY</span>
<a name="l00523"></a>00523 <span class="comment"></span>
<a name="l00524"></a>00524 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00525"></a>00525 <a class="code" href="cmpi_o_s_base___c_s_hosted_route_provider_8c.html#a327fa2fe6ce10d502bb0058f4ed3945c">CMInstanceMIStub</a>(OSBase_LANEndpointProvider,
<a name="l00526"></a>00526                  OSBase_LANEndpointProvider,
<a name="l00527"></a>00527                  <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>,
<a name="l00528"></a>00528                  CMNoHook);
<a name="l00529"></a>00529 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00530"></a>00530 
<a name="l00531"></a>00531 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00532"></a>00532 <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#aab150ca7de72138dd52b272444728b5c">CMMethodMIStub</a>(OSBase_LANEndpointProvider,
<a name="l00533"></a>00533                OSBase_LANEndpointProvider,
<a name="l00534"></a>00534                <a class="code" href="cmpi_o_s_base___l_a_n_endpoint_provider_8c.html#a04019a4fbec5a9013e08c1d5621320cb">_broker</a>,
<a name="l00535"></a>00535                CMNoHook);
<a name="l00536"></a>00536 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00537"></a>00537 
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 20 Mar 2010 for cmpi-router by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
