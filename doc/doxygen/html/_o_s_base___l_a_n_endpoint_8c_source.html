<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>cmpi-router: /mnt/storage/cygnus/TESIS/sblim/cmpi-router/src/OSBase_LANEndpoint.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>/mnt/storage/cygnus/TESIS/sblim/cmpi-router/src/OSBase_LANEndpoint.c</h1><a href="_o_s_base___l_a_n_endpoint_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;sys/socket.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;linux/if.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;linux/rtnetlink.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;signal.h&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;errno.h&gt;</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;OSBase_Common.h&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="_o_s_base___l_a_n_endpoint_8h.html">OSBase_LANEndpoint.h</a>&quot;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 
<a name="l00035"></a>00035 <span class="comment">// COMMON</span>
<a name="l00037"></a>00037 <span class="comment"></span>
<a name="l00038"></a>00038 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00046"></a><a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a4516f8c4ceb2bb917acb8e3e4e5cedb9">00046</a> <span class="comment"></span><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a4516f8c4ceb2bb917acb8e3e4e5cedb9">datetime_str_interval_to_ms</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *pDatetimeString) {
<a name="l00047"></a>00047     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- datetime_str_interval_to_ms() called&quot;</span>));
<a name="l00048"></a>00048 
<a name="l00049"></a>00049     <span class="keywordtype">int</span> days = 0, hours = 0, minutes = 0, seconds = 0, mseconds = 0;
<a name="l00050"></a>00050     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> totalSeconds = 0;
<a name="l00051"></a>00051 
<a name="l00052"></a>00052     sscanf(pDatetimeString, <span class="stringliteral">&quot;%8d%2d%2d%2d.%6d:000&quot;</span>, &amp;days, &amp;hours,
<a name="l00053"></a>00053            &amp;minutes, &amp;seconds, &amp;mseconds);
<a name="l00054"></a>00054     totalSeconds += (mseconds);
<a name="l00055"></a>00055     totalSeconds += (seconds*1000);
<a name="l00056"></a>00056     totalSeconds += (minutes*1000*60);
<a name="l00057"></a>00057     totalSeconds += (hours*1000*60*60);
<a name="l00058"></a>00058     totalSeconds += (days*1000*60*60*24);
<a name="l00059"></a>00059 
<a name="l00060"></a>00060     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- datetime_str_interval_to_ms() exited&quot;</span>));
<a name="l00061"></a>00061     <span class="keywordflow">return</span> totalSeconds;
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00066"></a><a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a93cd8187af6d71b81bbdcb57a1fc91a7">00066</a> <span class="keywordtype">int</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a93cd8187af6d71b81bbdcb57a1fc91a7">getLANEndpoints</a>(<span class="keyword">struct</span> <a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> **lanEPList,
<a name="l00067"></a>00067                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structnl_link_info.html">nlLinkInfo</a> *<a class="code" href="structnl_link_info.html">nlLinkInfo</a>)
<a name="l00068"></a>00068 {
<a name="l00069"></a>00069     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- getLANEndpoints() called&quot;</span>));
<a name="l00070"></a>00070 
<a name="l00071"></a>00071     <span class="keyword">struct </span><a class="code" href="structnl_link_info_list.html">nlLinkInfoList</a> *list = NULL;   <span class="comment">// Netlink links list.</span>
<a name="l00072"></a>00072     <span class="keywordtype">int</span>                    rc   = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>; <span class="comment">// Result handler.</span>
<a name="l00073"></a>00073 
<a name="l00074"></a>00074     <span class="comment">// Check link info (used as filter).</span>
<a name="l00075"></a>00075     <span class="keywordflow">if</span>(nlLinkInfo == NULL) {
<a name="l00076"></a>00076         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Invalid filter.&quot;</span>));
<a name="l00077"></a>00077         rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00078"></a>00078         <span class="keywordflow">goto</span> out;
<a name="l00079"></a>00079     }
<a name="l00080"></a>00080 
<a name="l00081"></a>00081     <span class="comment">// Open netlink socket.</span>
<a name="l00082"></a>00082     <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___netlink_8h.html#adbd0d1b2c87161a38f388f0aff6330ce">nlOpenSocket</a>() != <a class="code" href="_o_s_base___netlink_8h.html#ac7d7c2614d84dd87d5d0566a4cbb6798">NL_OK</a>) {
<a name="l00083"></a>00083         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Unable to open netlink socket.&quot;</span>));
<a name="l00084"></a>00084         rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00085"></a>00085         <span class="keywordflow">goto</span> out;
<a name="l00086"></a>00086     }
<a name="l00087"></a>00087 
<a name="l00088"></a>00088     <span class="comment">// Get LANEndpoint.</span>
<a name="l00089"></a>00089     <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___netlink_8h.html#aa90fe0abb39fe8181af62635d48e9f8f">nlGetLinks</a>(&amp;list, nlLinkInfo) != <a class="code" href="_o_s_base___netlink_8h.html#ac7d7c2614d84dd87d5d0566a4cbb6798">NL_OK</a>) {
<a name="l00090"></a>00090         <a class="code" href="_o_s_base___netlink_8h.html#a8a09ea63ead7608a1b6f1b4013ff4e55">nlCloseSocket</a>();
<a name="l00091"></a>00091         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Unable to get LANEndpoint.&quot;</span>));
<a name="l00092"></a>00092         rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00093"></a>00093         <span class="keywordflow">goto</span> out;
<a name="l00094"></a>00094     }
<a name="l00095"></a>00095 
<a name="l00096"></a>00096     <span class="comment">// Close netlink socket.</span>
<a name="l00097"></a>00097     <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___netlink_8h.html#a8a09ea63ead7608a1b6f1b4013ff4e55">nlCloseSocket</a>() != <a class="code" href="_o_s_base___netlink_8h.html#ac7d7c2614d84dd87d5d0566a4cbb6798">NL_OK</a>) {
<a name="l00098"></a>00098         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Unable to close netlink socket.&quot;</span>));
<a name="l00099"></a>00099         rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00100"></a>00100         <span class="keywordflow">goto</span> out;
<a name="l00101"></a>00101     }
<a name="l00102"></a>00102 
<a name="l00103"></a>00103     <span class="comment">// Convert list.</span>
<a name="l00104"></a>00104     <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a1cfc38a0229aa40f4f9bb549de1a5edc">nlListTOLanEPList</a>(&amp;list, lanEPList) != <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>) {
<a name="l00105"></a>00105         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Could not convert netlink links list to &quot;</span> \
<a name="l00106"></a>00106                           <span class="stringliteral">&quot;LANEndpoint links list.&quot;</span>));
<a name="l00107"></a>00107         rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00108"></a>00108         <span class="keywordflow">goto</span> out;
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111  out:
<a name="l00112"></a>00112     <a class="code" href="_o_s_base___netlink_8h.html#a63fac149c2d915408bf3cf85f5484e69">nlFreeLinkInfoList</a>(list);
<a name="l00113"></a>00113     <span class="keywordflow">if</span>(rc == <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>) {
<a name="l00114"></a>00114         <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0ff3f1739478cd89305b5dbb5240aaad">freeLANEndpointList</a>(*lanEPList);
<a name="l00115"></a>00115         <a class="code" href="_o_s_base___netlink_8h.html#a5a8431d964a3eb0bc6ec073a4d90a651">FREE_SAFE</a>(lanEPList);
<a name="l00116"></a>00116     }
<a name="l00117"></a>00117 
<a name="l00118"></a>00118     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- getLANEndpoints() exited&quot;</span>));
<a name="l00119"></a>00119     <span class="keywordflow">return</span> rc;
<a name="l00120"></a>00120 }
<a name="l00121"></a>00121 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00124"></a><a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a912c0a67e9c08a00c9c4af12c5d9fe4c">00124</a> <span class="keywordtype">int</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a912c0a67e9c08a00c9c4af12c5d9fe4c">getALLLANEndpoints</a>(<span class="keyword">struct</span> <a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> **list)
<a name="l00125"></a>00125 {
<a name="l00126"></a>00126     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- getALLLANEndpoints() called&quot;</span>));
<a name="l00127"></a>00127 
<a name="l00128"></a>00128     <span class="keyword">struct </span><a class="code" href="structnl_link_info.html">nlLinkInfo</a> nlLinkInfo;  <span class="comment">// Filter.</span>
<a name="l00129"></a>00129     <span class="keywordtype">int</span>               rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>; <span class="comment">// Result handler.</span>
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <span class="comment">// Generic link info (used as filter).</span>
<a name="l00132"></a>00132     <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___netlink_8h.html#a40b120c823bc8b5ef4136be1f86cf29c">nlCreateDefaultLinkInfo</a>(&amp;nlLinkInfo) != <a class="code" href="_o_s_base___netlink_8h.html#ac7d7c2614d84dd87d5d0566a4cbb6798">NL_OK</a>) {
<a name="l00133"></a>00133         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Could not create default link &quot;</span> \
<a name="l00134"></a>00134                           <span class="stringliteral">&quot;info filter.&quot;</span>));
<a name="l00135"></a>00135         rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00136"></a>00136         <span class="keywordflow">goto</span> out;
<a name="l00137"></a>00137     }
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     <span class="comment">// Get LANEndpoint.</span>
<a name="l00140"></a>00140     <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a93cd8187af6d71b81bbdcb57a1fc91a7">getLANEndpoints</a>(list, &amp;nlLinkInfo) != <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>) {
<a name="l00141"></a>00141         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Could not get LANEndpoints.&quot;</span>));
<a name="l00142"></a>00142         rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00143"></a>00143         <span class="keywordflow">goto</span> out;
<a name="l00144"></a>00144     }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146  out:
<a name="l00147"></a>00147     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- getALLLANEndpoints() exited&quot;</span>));
<a name="l00148"></a>00148     <span class="keywordflow">return</span> rc;
<a name="l00149"></a>00149 }
<a name="l00150"></a>00150 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00153"></a><a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a0e24fae564ca4e06b1a7e8ce7c246ce5">00153</a> <span class="keywordtype">int</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0e24fae564ca4e06b1a7e8ce7c246ce5">getLANEndpoint</a>(<span class="keyword">struct</span> <a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> **lanEPList, <span class="keyword">const</span> <span class="keywordtype">char</span> *linkName)
<a name="l00154"></a>00154 {
<a name="l00155"></a>00155     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- getLANEndpoint() called&quot;</span>));
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <span class="keyword">struct </span><a class="code" href="structnl_link_info.html">nlLinkInfo</a> nlLinkInfo;  <span class="comment">// Filter.</span>
<a name="l00158"></a>00158     <span class="keywordtype">int</span>               rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>; <span class="comment">// Result handler.</span>
<a name="l00159"></a>00159 
<a name="l00160"></a>00160     <span class="comment">// Generic link info (used as filter).</span>
<a name="l00161"></a>00161     <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___netlink_8h.html#a40b120c823bc8b5ef4136be1f86cf29c">nlCreateDefaultLinkInfo</a>(&amp;nlLinkInfo) != <a class="code" href="_o_s_base___netlink_8h.html#ac7d7c2614d84dd87d5d0566a4cbb6798">NL_OK</a>) {
<a name="l00162"></a>00162         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Could not create default link &quot;</span> \
<a name="l00163"></a>00163                           <span class="stringliteral">&quot;info filter.&quot;</span>));
<a name="l00164"></a>00164         rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00165"></a>00165         <span class="keywordflow">goto</span> out;
<a name="l00166"></a>00166     }
<a name="l00167"></a>00167     
<a name="l00168"></a>00168     <span class="comment">// Add ifname.</span>
<a name="l00169"></a>00169     snprintf(nlLinkInfo.<a class="code" href="structnl_link_info.html#ac7b430acaa92a7a26fbcdad47d2efc20">ifname</a>, IFNAMSIZ, <span class="stringliteral">&quot;%s&quot;</span>, linkName);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171     <span class="comment">// Get LANEndpoint.</span>
<a name="l00172"></a>00172     <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a93cd8187af6d71b81bbdcb57a1fc91a7">getLANEndpoints</a>(lanEPList, &amp;nlLinkInfo) != <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>) {
<a name="l00173"></a>00173         _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Could not get LANEndpoints.&quot;</span>));
<a name="l00174"></a>00174         rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00175"></a>00175         <span class="keywordflow">goto</span> out;
<a name="l00176"></a>00176     }
<a name="l00177"></a>00177 
<a name="l00178"></a>00178  out:
<a name="l00179"></a>00179     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- getLANEndpoint() exited&quot;</span>));
<a name="l00180"></a>00180     <span class="keywordflow">return</span> rc;
<a name="l00181"></a>00181 }
<a name="l00182"></a>00182 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00185"></a><a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#ab96e1416278e303b6eeb6fe2feb0af82">00185</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab96e1416278e303b6eeb6fe2feb0af82">changeLinkOPState</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *linkName,
<a name="l00186"></a>00186                                  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> enabledState,
<a name="l00187"></a>00187                                  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> timeoutPeriod)
<a name="l00188"></a>00188 {
<a name="l00189"></a>00189     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- changeLinkOPState() called&quot;</span>));
<a name="l00190"></a>00190 
<a name="l00191"></a>00191     <span class="keyword">struct </span><a class="code" href="structnl_link_info.html">nlLinkInfo</a> nlLinkInfo; <span class="comment">// Filter.</span>
<a name="l00192"></a>00192     pid_t             cpid = 0;   <span class="comment">// Child process id.</span>
<a name="l00193"></a>00193     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>    rc   = 0;   <span class="comment">// Result.</span>
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <span class="comment">// Creating a child process.</span>
<a name="l00196"></a>00196     <span class="keywordflow">if</span>(timeoutPeriod != 0) {
<a name="l00197"></a>00197         cpid = fork();
<a name="l00198"></a>00198         <span class="keywordflow">if</span>(cpid == -1) {
<a name="l00199"></a>00199             rc = 2;
<a name="l00200"></a>00200             <span class="keywordflow">goto</span> out;
<a name="l00201"></a>00201         }
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204     <span class="keywordflow">if</span>(cpid == 0) { <span class="comment">// Code executed by child.</span>
<a name="l00205"></a>00205         <span class="comment">// Generic link info.</span>
<a name="l00206"></a>00206         <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___netlink_8h.html#a40b120c823bc8b5ef4136be1f86cf29c">nlCreateDefaultLinkInfo</a>(&amp;nlLinkInfo) != <a class="code" href="_o_s_base___netlink_8h.html#ac7d7c2614d84dd87d5d0566a4cbb6798">NL_OK</a>) {
<a name="l00207"></a>00207             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Could not create default link info.&quot;</span>));
<a name="l00208"></a>00208             rc = 4;
<a name="l00209"></a>00209             <span class="keywordflow">goto</span> out;
<a name="l00210"></a>00210         }
<a name="l00211"></a>00211 
<a name="l00212"></a>00212         <span class="keywordflow">switch</span>(enabledState) {
<a name="l00213"></a>00213         <span class="keywordflow">case</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a1f5090a2c36ad9e248c2f2462ca6b81d">LEP_RS_ENABLED</a>:
<a name="l00214"></a>00214             nlLinkInfo.<a class="code" href="structnl_link_info.html#adda9fdcf309da55ca70fe8fa44228669">change</a> |= IFF_UP;
<a name="l00215"></a>00215             nlLinkInfo.<a class="code" href="structnl_link_info.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> |= IFF_UP;
<a name="l00216"></a>00216             <span class="comment">// nlLinkInfo.operstate = IF_OPER_UP;</span>
<a name="l00217"></a>00217             <span class="keywordflow">break</span>;
<a name="l00218"></a>00218         <span class="keywordflow">case</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a51474f9c38cf7486103c2d7aa0518bbd">LEP_RS_DISABLED</a>:
<a name="l00219"></a>00219             nlLinkInfo.<a class="code" href="structnl_link_info.html#adda9fdcf309da55ca70fe8fa44228669">change</a> |= IFF_UP;
<a name="l00220"></a>00220             nlLinkInfo.<a class="code" href="structnl_link_info.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> &amp;= ~IFF_UP;
<a name="l00221"></a>00221             <span class="comment">// nlLinkInfo.operstate = IF_OPER_DOWN;</span>
<a name="l00222"></a>00222             <span class="keywordflow">break</span>;
<a name="l00223"></a>00223         <span class="keywordflow">case</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a92c8ceb4b316e95e7519eb0bad4a0aaa">LEP_RS_SHUT_DOWN</a>:
<a name="l00224"></a>00224         <span class="keywordflow">case</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a3d436eadd639331719c7d767c4f9bac4">LEP_RS_OFFLINE</a>:
<a name="l00225"></a>00225             <span class="comment">// nlLinkInfo.operstate = IF_OPER_DORMANT;</span>
<a name="l00226"></a>00226             <span class="keywordflow">break</span>;
<a name="l00227"></a>00227         <span class="keywordflow">case</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a15569ea352d602e975551a48840bd851">LEP_RS_TEST</a>:
<a name="l00228"></a>00228             <span class="comment">// nlLinkInfo.operstate = IF_OPER_TESTING;</span>
<a name="l00229"></a>00229             <span class="keywordflow">break</span>;
<a name="l00230"></a>00230         <span class="keywordflow">case</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a73863b380241373c7566ef4648210e7b">LEP_RS_DEFERRED</a>:
<a name="l00231"></a>00231         <span class="keywordflow">case</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04acd549d13e2f75a8e6d5d5bc7ae841b98">LEP_RS_QUIESCE</a>:
<a name="l00232"></a>00232         <span class="keywordflow">case</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a7fcbffbc1268a826e153493439a70997">LEP_RS_REBOOT</a>:
<a name="l00233"></a>00233         <span class="keywordflow">case</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a78e7c276617ae1c05239db9edf5af25e">LEP_RS_RESET</a>:
<a name="l00234"></a>00234             <span class="keywordflow">break</span>;
<a name="l00235"></a>00235         <span class="keywordflow">default</span>:
<a name="l00236"></a>00236             rc = 5;
<a name="l00237"></a>00237             <span class="keywordflow">goto</span> out;
<a name="l00238"></a>00238         }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240         <span class="comment">// Setting link ifname.</span>
<a name="l00241"></a>00241         snprintf(nlLinkInfo.<a class="code" href="structnl_link_info.html#ac7b430acaa92a7a26fbcdad47d2efc20">ifname</a>, IFNAMSIZ, <span class="stringliteral">&quot;%s&quot;</span>, linkName);
<a name="l00242"></a>00242 
<a name="l00243"></a>00243         <span class="comment">// Open netlink socket.</span>
<a name="l00244"></a>00244         <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___netlink_8h.html#adbd0d1b2c87161a38f388f0aff6330ce">nlOpenSocket</a>() != <a class="code" href="_o_s_base___netlink_8h.html#ac7d7c2614d84dd87d5d0566a4cbb6798">NL_OK</a>) {
<a name="l00245"></a>00245             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Unable to open netlink socket.&quot;</span>));
<a name="l00246"></a>00246             rc = 4;
<a name="l00247"></a>00247             <span class="keywordflow">goto</span> out;
<a name="l00248"></a>00248         }
<a name="l00249"></a>00249 
<a name="l00250"></a>00250         <span class="comment">// Change state.</span>
<a name="l00251"></a>00251         <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___netlink_8h.html#ab22ff84b6b0e7f1784619098eec647fe">nlModifyLink</a>(&amp;nlLinkInfo, RTM_NEWLINK, 0) != <a class="code" href="_o_s_base___netlink_8h.html#ac7d7c2614d84dd87d5d0566a4cbb6798">NL_OK</a>) {
<a name="l00252"></a>00252             <a class="code" href="_o_s_base___netlink_8h.html#a8a09ea63ead7608a1b6f1b4013ff4e55">nlCloseSocket</a>();
<a name="l00253"></a>00253             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Unable to change link operative &quot;</span> \
<a name="l00254"></a>00254                               <span class="stringliteral">&quot;state.&quot;</span>));
<a name="l00255"></a>00255             rc = 4;
<a name="l00256"></a>00256             <span class="keywordflow">goto</span> out;
<a name="l00257"></a>00257         }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259         <span class="comment">// Close netlink socket.</span>
<a name="l00260"></a>00260         <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___netlink_8h.html#a8a09ea63ead7608a1b6f1b4013ff4e55">nlCloseSocket</a>() != <a class="code" href="_o_s_base___netlink_8h.html#ac7d7c2614d84dd87d5d0566a4cbb6798">NL_OK</a>) {
<a name="l00261"></a>00261             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Unable to close netlink socket.&quot;</span>));
<a name="l00262"></a>00262             rc = 4;
<a name="l00263"></a>00263             <span class="keywordflow">goto</span> out;
<a name="l00264"></a>00264         }
<a name="l00265"></a>00265     } <span class="keywordflow">else</span> { <span class="comment">// Code executed by parent.</span>
<a name="l00266"></a>00266         <span class="comment">// Kill child after specified milliseconds.</span>
<a name="l00267"></a>00267         <span class="keywordflow">if</span>(usleep(timeoutPeriod) != 0) {
<a name="l00268"></a>00268             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - usleep error. %s&quot;</span>, strerror(errno)));
<a name="l00269"></a>00269             rc = 2;
<a name="l00270"></a>00270             <span class="keywordflow">goto</span> out;
<a name="l00271"></a>00271         }
<a name="l00272"></a>00272         <span class="keywordflow">if</span>(kill(cpid, SIGKILL) != 0) {
<a name="l00273"></a>00273             _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Could not kill process. %s&quot;</span>,
<a name="l00274"></a>00274                               strerror(errno)));
<a name="l00275"></a>00275             rc = 2;
<a name="l00276"></a>00276             <span class="keywordflow">goto</span> out;
<a name="l00277"></a>00277         }
<a name="l00278"></a>00278         cpid = -1;
<a name="l00279"></a>00279         rc = 3;
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281 
<a name="l00282"></a>00282  out:
<a name="l00283"></a>00283     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- changeLinkOPState() exited&quot;</span>));
<a name="l00284"></a>00284     <span class="keywordflow">return</span> rc;
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00287"></a>00287 
<a name="l00288"></a>00288 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00289"></a><a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a1cfc38a0229aa40f4f9bb549de1a5edc">00289</a> <span class="keywordtype">int</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a1cfc38a0229aa40f4f9bb549de1a5edc">nlListTOLanEPList</a>(<span class="keyword">struct</span> <a class="code" href="structnl_link_info_list.html">nlLinkInfoList</a> **<a class="code" href="structnl_link_info_list.html">nlLinkInfoList</a>,
<a name="l00290"></a>00290                       <span class="keyword">struct</span> <a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> **lanEPList)
<a name="l00291"></a>00291 {
<a name="l00292"></a>00292     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- nlListTOLanEPList() called&quot;</span>));
<a name="l00293"></a>00293 
<a name="l00294"></a>00294     <span class="keyword">struct </span>nlLinkInfoList  *nlLinkInfoListCurr = NULL;   <span class="comment">// Current link info.</span>
<a name="l00295"></a>00295     <span class="keyword">struct </span><a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> *lanEPListCurr      = NULL;   <span class="comment">// Current LANEndpoint.</span>
<a name="l00296"></a>00296     <span class="keywordtype">int</span>                     rc                 = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>; <span class="comment">// Result handler.</span>
<a name="l00297"></a>00297 
<a name="l00298"></a>00298     nlLinkInfoListCurr = *nlLinkInfoList;
<a name="l00299"></a>00299     <span class="keywordflow">while</span>(nlLinkInfoListCurr != NULL) {
<a name="l00300"></a>00300         <span class="keywordflow">if</span>(nlLinkInfoListCurr-&gt;<a class="code" href="structnl_link_info_list.html#a7956ff417c4ef804785519e651457d89">sptr</a> != NULL) {
<a name="l00301"></a>00301             <span class="comment">// Create new LANEndpoint struct and temp containers variables.</span>
<a name="l00302"></a>00302             lanEPListCurr = malloc(<span class="keyword">sizeof</span>(*lanEPListCurr));
<a name="l00303"></a>00303             <span class="keywordflow">if</span>(lanEPListCurr == NULL) {
<a name="l00304"></a>00304                 _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Could not alloc memory for &quot;</span> \
<a name="l00305"></a>00305                                   <span class="stringliteral">&quot;\&apos;lanEPListCurr\&apos;.&quot;</span>));
<a name="l00306"></a>00306                 rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00307"></a>00307                 <span class="keywordflow">goto</span> out;
<a name="l00308"></a>00308             }
<a name="l00309"></a>00309             memset(lanEPListCurr, 0, <span class="keyword">sizeof</span>(*lanEPListCurr));
<a name="l00310"></a>00310 
<a name="l00311"></a>00311             lanEPListCurr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a> = malloc(<span class="keyword">sizeof</span>(*(lanEPListCurr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a>)));
<a name="l00312"></a>00312             <span class="keywordflow">if</span>(lanEPListCurr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a> == NULL) {
<a name="l00313"></a>00313                 <a class="code" href="_o_s_base___netlink_8h.html#a5a8431d964a3eb0bc6ec073a4d90a651">FREE_SAFE</a>(lanEPListCurr);
<a name="l00314"></a>00314                 _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Could not alloc memory for &quot;</span> \
<a name="l00315"></a>00315                                   <span class="stringliteral">&quot;\&apos;lanEPListCurr-&gt;sptr\&apos;.&quot;</span>));
<a name="l00316"></a>00316                 rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00317"></a>00317                 <span class="keywordflow">goto</span> out;
<a name="l00318"></a>00318             }
<a name="l00319"></a>00319             memset(lanEPListCurr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a>, 0, <span class="keyword">sizeof</span>(*(lanEPListCurr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a>)));
<a name="l00320"></a>00320 
<a name="l00321"></a>00321             <span class="comment">// Convert from nl to LANEndpoint.</span>
<a name="l00322"></a>00322             <span class="keywordflow">if</span>(<a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a06810d11e411c5ed06363cbf22d6ffb7">nlInfoTOLanEP</a>(nlLinkInfoListCurr-&gt;<a class="code" href="structnl_link_info_list.html#a7956ff417c4ef804785519e651457d89">sptr</a>,
<a name="l00323"></a>00323                              lanEPListCurr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a>) != <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>) {
<a name="l00324"></a>00324                 <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0ff3f1739478cd89305b5dbb5240aaad">freeLANEndpointList</a>(lanEPListCurr);
<a name="l00325"></a>00325                 _OSBASE_TRACE(1, (<span class="stringliteral">&quot;[ERROR] - Could not convert structure &quot;</span> \
<a name="l00326"></a>00326                                   <span class="stringliteral">&quot;from nl to LANEndpoint.&quot;</span>));
<a name="l00327"></a>00327                 rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74fd4d8065ac8872abd1ce8ab029ac82">LEP_FAIL</a>;
<a name="l00328"></a>00328                 <span class="keywordflow">goto</span> out;
<a name="l00329"></a>00329             }
<a name="l00330"></a>00330 
<a name="l00331"></a>00331             <span class="comment">// Set next LANEndpoint.</span>
<a name="l00332"></a>00332             lanEPListCurr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#a73dddd0fd4134de1e21beaba4329d0ac">next</a> = *lanEPList;
<a name="l00333"></a>00333             *lanEPList = lanEPListCurr;
<a name="l00334"></a>00334         }
<a name="l00335"></a>00335         nlLinkInfoListCurr = nlLinkInfoListCurr-&gt;<a class="code" href="structnl_link_info_list.html#a38363837a3f5f555e8f3a772b93986bb">next</a>;
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337 
<a name="l00338"></a>00338  out:
<a name="l00339"></a>00339     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- nlListTOLanEPList() exited&quot;</span>));
<a name="l00340"></a>00340     <span class="keywordflow">return</span> rc;
<a name="l00341"></a>00341 }
<a name="l00342"></a>00342 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00345"></a><a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a06810d11e411c5ed06363cbf22d6ffb7">00345</a> <span class="keywordtype">int</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a06810d11e411c5ed06363cbf22d6ffb7">nlInfoTOLanEP</a>(<span class="keyword">struct</span> <a class="code" href="structnl_link_info.html">nlLinkInfo</a> *<a class="code" href="structnl_link_info.html">nlLinkInfo</a>,
<a name="l00346"></a>00346                   <span class="keyword">struct</span> <a class="code" href="struct_l_a_n_endpoint.html">LANEndpoint</a> *lanEP)
<a name="l00347"></a>00347 {
<a name="l00348"></a>00348     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- nlInfoTOLanEP() called&quot;</span>));
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     <span class="keywordtype">int</span> typePos = 0;      <span class="comment">// Link type.</span>
<a name="l00351"></a>00351     <span class="keywordtype">int</span> rc      = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>; <span class="comment">// Result handler.</span>
<a name="l00352"></a>00352 
<a name="l00353"></a>00353     <span class="comment">// MacAddress.</span>
<a name="l00354"></a>00354     <a class="code" href="_o_s_base___netlink_8h.html#ad6b3d1f52fb7339b7ff7e09409de914d">nlAddr_n2a</a>(nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#a47f1d37ed4036597b5349643cdf0ee95">address</a>, nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#a40ac8032a304ec8c7e75994741c59674">addressLen</a>,
<a name="l00355"></a>00355                nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#aa929142c5ddf34cf0915c97a617a1a63">type</a>, lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ad93c6705b6e27c077473da7d9c059d35">macAddress</a>, 32);
<a name="l00356"></a>00356 
<a name="l00357"></a>00357     <span class="comment">// Name.</span>
<a name="l00358"></a>00358     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a8e03167ce04350be901b028cc4cf1ce1">name</a>, 256, <span class="stringliteral">&quot;%s&quot;</span>, nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#ac7b430acaa92a7a26fbcdad47d2efc20">ifname</a>);
<a name="l00359"></a>00359 
<a name="l00360"></a>00360     <span class="comment">// Caption.</span>
<a name="l00361"></a>00361     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#aedfd9c5424c9aa2ef6df1a16f9220d6f">caption</a>, 64, <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ae03dfeb08993a673daac5875bf43a17b">LANENDPOINT_CAPTION</a>);
<a name="l00362"></a>00362 
<a name="l00363"></a>00363     <span class="comment">// CreationClassName.</span>
<a name="l00364"></a>00364     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a264b859577affb8c648bb0dea4f42a76">creationClassName</a>, 256, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab8af03c95cfe4a4fd9601a8271a43b43">CREATION_CLASS_NAME</a>);
<a name="l00365"></a>00365 
<a name="l00366"></a>00366     <span class="comment">// Description.</span>
<a name="l00367"></a>00367     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a18afc38b5c05344b661e1b3b01c1d0e5">description</a>, 256, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a36798f62c5b8cd4866824a5024ce3108">LANENDPOINT_DESC</a>);
<a name="l00368"></a>00368 
<a name="l00369"></a>00369     <span class="comment">// ElementName.</span>
<a name="l00370"></a>00370     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a1c9372777e720027e94df62b3274a7fb">elementName</a>, 64, <span class="stringliteral">&quot;%s_%d&quot;</span>, lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a8e03167ce04350be901b028cc4cf1ce1">name</a>, nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#a750b5d744c39a06bfb13e6eb010e35d0">index</a>);
<a name="l00371"></a>00371 
<a name="l00372"></a>00372     <span class="comment">// CommunicationStatus, DetailedStatus, EnabledState, HealthState,</span>
<a name="l00373"></a>00373     <span class="comment">// OperatingStatus, PrimaryStatus, OperationalStatus.</span>
<a name="l00374"></a>00374     <span class="keywordflow">if</span>(nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#a6389aebefc5f2ef983c0fccfbdb0e042">operstate</a> == IF_OPER_UNKNOWN) {
<a name="l00375"></a>00375         <span class="keywordflow">if</span>((nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> &amp; IFF_UP) &amp;&amp;
<a name="l00376"></a>00376            (nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#ac92588540e8c1d014a08cd8a45462b19">flags</a> &amp; IFF_LOWER_UP)) {
<a name="l00377"></a>00377             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a17887524776f566e094b52c5dd5ec5f5">communicationStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adc29c2ff13d900c2f185ee95427fb06ca22506e42995f0cd3de94ae0aeaaab773">LEP_CS_COMMUNICATION_OK</a>;
<a name="l00378"></a>00378             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ad90b9e45caede4967b5412b9f8be047c">detailedStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a61dadd085c1777f559549e05962b2c9ea584cc4b369a58ef5ef31cafbfb9300d5">LEP_DS_NO_ADDITIONAL_INFORMATION</a>;
<a name="l00379"></a>00379             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a719c20be3591f4cfad2db11f3410fe10">enabledState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a4cbfec42c62ed0f4adde3d761348a208">LEP_ES_ENABLED</a>;
<a name="l00380"></a>00380             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#abe815d40163da155690cb848f45d5c5a">healthState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a726ca809ffd3d67ab4b8476646f26635a6136d155b5a5e1e498b67448d4aee1fd">LEP_HS_OK</a>;
<a name="l00381"></a>00381             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a08774f9e8143e5d2e4e71dac9b13d900">operatingStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da26c2a481c50c0f616c7d94f6fb0f1270">LEP_OS_IN_SERVICE</a>;
<a name="l00382"></a>00382             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a83b43042974812be35c3c4327fc06150">primaryStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a6a6b43dd7cbbee9b496e89008ccc5cfd">LEP_PS_OK</a>;
<a name="l00383"></a>00383             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#af6ba95b300b99b25169364341eed22cb">operationalStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abed82baf7f470b522273a3e37c24c600a80c21beea7f4505c12a289f275c38a66">LEP_OPS_OK</a>;
<a name="l00384"></a>00384         } <span class="keywordflow">else</span> {
<a name="l00385"></a>00385             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a17887524776f566e094b52c5dd5ec5f5">communicationStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adc29c2ff13d900c2f185ee95427fb06cab7e16fa2f7783d9d35736fcd53cdeee7">LEP_CS_UNKNOWN</a>;
<a name="l00386"></a>00386             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ad90b9e45caede4967b5412b9f8be047c">detailedStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a61dadd085c1777f559549e05962b2c9ea48e92dfb412f80b22862367ac19f0fbd">LEP_DS_NON_RECOVERABLE_ERROR</a>;
<a name="l00387"></a>00387             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a719c20be3591f4cfad2db11f3410fe10">enabledState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a8fead427450bcd2f9d605f29495ae6a2">LEP_ES_DISABLED</a>;
<a name="l00388"></a>00388             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#abe815d40163da155690cb848f45d5c5a">healthState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a726ca809ffd3d67ab4b8476646f26635a387a776e4eb879a6d0d5c7b3e0472222">LEP_HS_UNKNOWN</a>;
<a name="l00389"></a>00389             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a08774f9e8143e5d2e4e71dac9b13d900">operatingStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dadf7caaa4e025007e5c378ddbd7220281">LEP_OS_UNKNOWN</a>;
<a name="l00390"></a>00390             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a83b43042974812be35c3c4327fc06150">primaryStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a48cf58fbd37ec5ea6a332e461b0c945b">LEP_PS_UNKNOWN</a>;
<a name="l00391"></a>00391             lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#af6ba95b300b99b25169364341eed22cb">operationalStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abed82baf7f470b522273a3e37c24c600a0b66a7f51d6dea5ff1f746d8c7e62608">LEP_OPS_UNKNOWN</a>;
<a name="l00392"></a>00392         }
<a name="l00393"></a>00393 
<a name="l00394"></a>00394     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#a6389aebefc5f2ef983c0fccfbdb0e042">operstate</a> == IF_OPER_NOTPRESENT) {
<a name="l00395"></a>00395         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a17887524776f566e094b52c5dd5ec5f5">communicationStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adc29c2ff13d900c2f185ee95427fb06cab7e16fa2f7783d9d35736fcd53cdeee7">LEP_CS_UNKNOWN</a>;
<a name="l00396"></a>00396         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ad90b9e45caede4967b5412b9f8be047c">detailedStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a61dadd085c1777f559549e05962b2c9ea48e92dfb412f80b22862367ac19f0fbd">LEP_DS_NON_RECOVERABLE_ERROR</a>;
<a name="l00397"></a>00397         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a719c20be3591f4cfad2db11f3410fe10">enabledState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a8fead427450bcd2f9d605f29495ae6a2">LEP_ES_DISABLED</a>;
<a name="l00398"></a>00398         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#abe815d40163da155690cb848f45d5c5a">healthState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a726ca809ffd3d67ab4b8476646f26635a4c6e09b1170fa2532a097eb16c541e65">LEP_HS_NON_RECOVERABLE_ERROR</a>;
<a name="l00399"></a>00399         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a08774f9e8143e5d2e4e71dac9b13d900">operatingStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da980551dbd9ba487c8222d5aa2febbedb">LEP_OS_ABORTED</a>;
<a name="l00400"></a>00400         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a83b43042974812be35c3c4327fc06150">primaryStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a939e58a3d0ba4a299cdf05582567d50a">LEP_PS_ERROR</a>;
<a name="l00401"></a>00401         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#af6ba95b300b99b25169364341eed22cb">operationalStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abed82baf7f470b522273a3e37c24c600a8f4a3a564d0d8b2f06c1275e7af40aef">LEP_OPS_NON_RECOVERABLE_ERROR</a>;
<a name="l00402"></a>00402 
<a name="l00403"></a>00403     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#a6389aebefc5f2ef983c0fccfbdb0e042">operstate</a> == IF_OPER_DOWN) {
<a name="l00404"></a>00404         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a17887524776f566e094b52c5dd5ec5f5">communicationStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adc29c2ff13d900c2f185ee95427fb06ca24dc988140e59c489b588eb5b6077568">LEP_CS_LOST_COMMUNICATION</a>;
<a name="l00405"></a>00405         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ad90b9e45caede4967b5412b9f8be047c">detailedStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a61dadd085c1777f559549e05962b2c9ea48e92dfb412f80b22862367ac19f0fbd">LEP_DS_NON_RECOVERABLE_ERROR</a>;
<a name="l00406"></a>00406         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a719c20be3591f4cfad2db11f3410fe10">enabledState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a8fead427450bcd2f9d605f29495ae6a2">LEP_ES_DISABLED</a>;
<a name="l00407"></a>00407         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#abe815d40163da155690cb848f45d5c5a">healthState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a726ca809ffd3d67ab4b8476646f26635a6b4cb183f7555eeb3b2930367da8b3a0">LEP_HS_CRITICAL_FAILURE</a>;
<a name="l00408"></a>00408         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a08774f9e8143e5d2e4e71dac9b13d900">operatingStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dadfb5d7b0dcc0f22926737d1cfbe78cca">LEP_OS_STOPPED</a>;
<a name="l00409"></a>00409         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a83b43042974812be35c3c4327fc06150">primaryStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a939e58a3d0ba4a299cdf05582567d50a">LEP_PS_ERROR</a>;
<a name="l00410"></a>00410         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#af6ba95b300b99b25169364341eed22cb">operationalStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abed82baf7f470b522273a3e37c24c600ad8f27442aa0784082d21c9772b1e2589">LEP_OPS_STOPPED</a>;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#a6389aebefc5f2ef983c0fccfbdb0e042">operstate</a> == IF_OPER_LOWERLAYERDOWN) {
<a name="l00413"></a>00413         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a17887524776f566e094b52c5dd5ec5f5">communicationStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adc29c2ff13d900c2f185ee95427fb06ca24dc988140e59c489b588eb5b6077568">LEP_CS_LOST_COMMUNICATION</a>;
<a name="l00414"></a>00414         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ad90b9e45caede4967b5412b9f8be047c">detailedStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a61dadd085c1777f559549e05962b2c9ea7baaa33a1a9a1a262b634b4e719a4808">LEP_DS_SUPPORTING_ENTITY_IN_ERROR</a>;
<a name="l00415"></a>00415         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a719c20be3591f4cfad2db11f3410fe10">enabledState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a8fead427450bcd2f9d605f29495ae6a2">LEP_ES_DISABLED</a>;
<a name="l00416"></a>00416         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#abe815d40163da155690cb848f45d5c5a">healthState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a726ca809ffd3d67ab4b8476646f26635afee17ba355aed1d9552ddb3dfb7a260f">LEP_HS_MAJOR_FAILURE</a>;
<a name="l00417"></a>00417         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a08774f9e8143e5d2e4e71dac9b13d900">operatingStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da980551dbd9ba487c8222d5aa2febbedb">LEP_OS_ABORTED</a>;
<a name="l00418"></a>00418         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a83b43042974812be35c3c4327fc06150">primaryStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a939e58a3d0ba4a299cdf05582567d50a">LEP_PS_ERROR</a>;
<a name="l00419"></a>00419         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#af6ba95b300b99b25169364341eed22cb">operationalStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abed82baf7f470b522273a3e37c24c600ae3e63259f95277aca2fb85f581f27624">LEP_OPS_SUPPORTING_ENTITY_IN_ERROR</a>;
<a name="l00420"></a>00420 
<a name="l00421"></a>00421     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#a6389aebefc5f2ef983c0fccfbdb0e042">operstate</a> == IF_OPER_TESTING) {
<a name="l00422"></a>00422         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a17887524776f566e094b52c5dd5ec5f5">communicationStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adc29c2ff13d900c2f185ee95427fb06ca24dc988140e59c489b588eb5b6077568">LEP_CS_LOST_COMMUNICATION</a>;
<a name="l00423"></a>00423         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ad90b9e45caede4967b5412b9f8be047c">detailedStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a61dadd085c1777f559549e05962b2c9ea48e92dfb412f80b22862367ac19f0fbd">LEP_DS_NON_RECOVERABLE_ERROR</a>;
<a name="l00424"></a>00424         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a719c20be3591f4cfad2db11f3410fe10">enabledState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a0dcf209de698e4eaeaea6289bd33a8bb">LEP_ES_IN_TEST</a>;
<a name="l00425"></a>00425         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#abe815d40163da155690cb848f45d5c5a">healthState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a726ca809ffd3d67ab4b8476646f26635a3868d60b0902f179660a360ad01afbb7">LEP_HS_MINOR_FAILURE</a>;
<a name="l00426"></a>00426         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a08774f9e8143e5d2e4e71dac9b13d900">operatingStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2daa3b125add9abb37eb2f72804775038fa">LEP_OS_IN_TEST</a>;
<a name="l00427"></a>00427         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a83b43042974812be35c3c4327fc06150">primaryStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a673c704893d0ab20a6c0030fc5d12916">LEP_PS_DEGRADED</a>;
<a name="l00428"></a>00428         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#af6ba95b300b99b25169364341eed22cb">operationalStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abed82baf7f470b522273a3e37c24c600a874417046524407cf78e52788d2423a4">LEP_OPS_IN_SERVICE</a>;
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#a6389aebefc5f2ef983c0fccfbdb0e042">operstate</a> == IF_OPER_DORMANT) {
<a name="l00431"></a>00431         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a17887524776f566e094b52c5dd5ec5f5">communicationStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adc29c2ff13d900c2f185ee95427fb06ca24dc988140e59c489b588eb5b6077568">LEP_CS_LOST_COMMUNICATION</a>;
<a name="l00432"></a>00432         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ad90b9e45caede4967b5412b9f8be047c">detailedStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a61dadd085c1777f559549e05962b2c9ea092d26c31722863711c425bd169b4dc7">LEP_DS_STRESSED</a>;
<a name="l00433"></a>00433         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a719c20be3591f4cfad2db11f3410fe10">enabledState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a76545b63f05c94df56e104e0a979b9df">LEP_ES_QUIESCE</a>;
<a name="l00434"></a>00434         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#abe815d40163da155690cb848f45d5c5a">healthState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a726ca809ffd3d67ab4b8476646f26635a6b4cb183f7555eeb3b2930367da8b3a0">LEP_HS_CRITICAL_FAILURE</a>;
<a name="l00435"></a>00435         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a08774f9e8143e5d2e4e71dac9b13d900">operatingStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da4cdb7624cdb6e5d75124c821b3fe0ed8">LEP_OS_DORMANT</a>;
<a name="l00436"></a>00436         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a83b43042974812be35c3c4327fc06150">primaryStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a673c704893d0ab20a6c0030fc5d12916">LEP_PS_DEGRADED</a>;
<a name="l00437"></a>00437         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#af6ba95b300b99b25169364341eed22cb">operationalStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abed82baf7f470b522273a3e37c24c600a46b071288ff1824aedf3a3d3e59c8de6">LEP_OPS_DORMANT</a>;
<a name="l00438"></a>00438 
<a name="l00439"></a>00439     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#a6389aebefc5f2ef983c0fccfbdb0e042">operstate</a> == IF_OPER_UP) {
<a name="l00440"></a>00440         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a17887524776f566e094b52c5dd5ec5f5">communicationStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adc29c2ff13d900c2f185ee95427fb06ca22506e42995f0cd3de94ae0aeaaab773">LEP_CS_COMMUNICATION_OK</a>;
<a name="l00441"></a>00441         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ad90b9e45caede4967b5412b9f8be047c">detailedStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a61dadd085c1777f559549e05962b2c9ea584cc4b369a58ef5ef31cafbfb9300d5">LEP_DS_NO_ADDITIONAL_INFORMATION</a>;
<a name="l00442"></a>00442         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a719c20be3591f4cfad2db11f3410fe10">enabledState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a4cbfec42c62ed0f4adde3d761348a208">LEP_ES_ENABLED</a>;
<a name="l00443"></a>00443         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#abe815d40163da155690cb848f45d5c5a">healthState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a726ca809ffd3d67ab4b8476646f26635a6136d155b5a5e1e498b67448d4aee1fd">LEP_HS_OK</a>;
<a name="l00444"></a>00444         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a08774f9e8143e5d2e4e71dac9b13d900">operatingStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da26c2a481c50c0f616c7d94f6fb0f1270">LEP_OS_IN_SERVICE</a>;
<a name="l00445"></a>00445         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a83b43042974812be35c3c4327fc06150">primaryStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a6a6b43dd7cbbee9b496e89008ccc5cfd">LEP_PS_OK</a>;
<a name="l00446"></a>00446         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#af6ba95b300b99b25169364341eed22cb">operationalStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abed82baf7f470b522273a3e37c24c600a80c21beea7f4505c12a289f275c38a66">LEP_OPS_OK</a>;
<a name="l00447"></a>00447 
<a name="l00448"></a>00448     } <span class="keywordflow">else</span> {
<a name="l00449"></a>00449         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a17887524776f566e094b52c5dd5ec5f5">communicationStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adc29c2ff13d900c2f185ee95427fb06ca24dc988140e59c489b588eb5b6077568">LEP_CS_LOST_COMMUNICATION</a>;
<a name="l00450"></a>00450         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ad90b9e45caede4967b5412b9f8be047c">detailedStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a61dadd085c1777f559549e05962b2c9ea972fe34f4e08e325575b85fc139a9529">LEP_DS_NOT_AVAILABLE</a>;
<a name="l00451"></a>00451         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a719c20be3591f4cfad2db11f3410fe10">enabledState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a8fead427450bcd2f9d605f29495ae6a2">LEP_ES_DISABLED</a>;
<a name="l00452"></a>00452         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#abe815d40163da155690cb848f45d5c5a">healthState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a726ca809ffd3d67ab4b8476646f26635a387a776e4eb879a6d0d5c7b3e0472222">LEP_HS_UNKNOWN</a>;
<a name="l00453"></a>00453         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a08774f9e8143e5d2e4e71dac9b13d900">operatingStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dadf7caaa4e025007e5c378ddbd7220281">LEP_OS_UNKNOWN</a>;
<a name="l00454"></a>00454         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a83b43042974812be35c3c4327fc06150">primaryStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a48cf58fbd37ec5ea6a332e461b0c945b">LEP_PS_UNKNOWN</a>;
<a name="l00455"></a>00455         lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#af6ba95b300b99b25169364341eed22cb">operationalStatus</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abed82baf7f470b522273a3e37c24c600a0b66a7f51d6dea5ff1f746d8c7e62608">LEP_OPS_UNKNOWN</a>;
<a name="l00456"></a>00456     }
<a name="l00457"></a>00457 
<a name="l00458"></a>00458     <span class="comment">// InstanceID.</span>
<a name="l00459"></a>00459     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a9c118b2dca982f7e028eac6ce61f473d">instanceID</a>, 64, <span class="stringliteral">&quot;%s-%s&quot;</span>, lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a8e03167ce04350be901b028cc4cf1ce1">name</a>, lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ad93c6705b6e27c077473da7d9c059d35">macAddress</a>);
<a name="l00460"></a>00460 
<a name="l00461"></a>00461     <span class="comment">// LanID.</span>
<a name="l00462"></a>00462     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ab5326c43b317d24e06693427a707553c">lanID</a>, 64, <span class="stringliteral">&quot;NULL&quot;</span>);
<a name="l00463"></a>00463 
<a name="l00464"></a>00464     <span class="comment">// MaxDataSize.</span>
<a name="l00465"></a>00465     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a029105f833e0c92826a6738c6d8f88fd">maxDataSize</a> = nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#a5ac894ab93685970e62fbf6756f38309">mtu</a>;
<a name="l00466"></a>00466 
<a name="l00467"></a>00467     <span class="comment">// NameFormat.</span>
<a name="l00468"></a>00468     <span class="comment">// We look the position of the link type into linkType array, then</span>
<a name="l00469"></a>00469     <span class="comment">// we can obtain the string representation from linkTypeName.</span>
<a name="l00470"></a>00470     typePos = <a class="code" href="_o_s_base___netlink_8h.html#a9b245db0c9ab2df29362ac0e6c58467e">nlGetLinkTypePos</a>(nlLinkInfo-&gt;<a class="code" href="structnl_link_info.html#aa929142c5ddf34cf0915c97a617a1a63">type</a>);
<a name="l00471"></a>00471     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a6ae2d79a0b453f2f74f7ed37b65611dc">nameFormat</a>, 256, <span class="stringliteral">&quot;%s&quot;</span>, <a class="code" href="_o_s_base___netlink_8h.html#af7dc4c7f2ea2bed08429f040127384d1">linkTypeName</a>[typePos]);
<a name="l00472"></a>00472 
<a name="l00473"></a>00473     <span class="comment">// OtherEnabledState.</span>
<a name="l00474"></a>00474     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ada8b1d0abb5f880f6c578111185472d0">otherEnabledState</a>, 64, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00475"></a>00475 
<a name="l00476"></a>00476     <span class="comment">// OtherTypeDescription.</span>
<a name="l00477"></a>00477     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ae3a0e27b88cd9e2a8cc4cfe80b63d320">otherTypeDescription</a>, 64, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00478"></a>00478 
<a name="l00479"></a>00479     <span class="comment">// ProtocolIFType.</span>
<a name="l00480"></a>00480     <span class="comment">// @todo implement, we need to take this info from snmp.</span>
<a name="l00481"></a>00481     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a414e382ad7c2c6ec9c934cfe5ca96dda">protocolIFType</a> = 0;
<a name="l00482"></a>00482 
<a name="l00483"></a>00483     <span class="comment">// RequestedState.</span>
<a name="l00484"></a>00484     <span class="comment">// @todo implement.</span>
<a name="l00485"></a>00485     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a8ef3ed2a286e0d72c33b29dfe265dba3">requestedState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a305fd2b1a221f387eadcd591dde2f479">LEP_RS_UNKNOWN</a>;
<a name="l00486"></a>00486 
<a name="l00487"></a>00487     <span class="comment">// SystemCreationClassName.</span>
<a name="l00488"></a>00488     <span class="comment">// @todo Defined in cmpiOSBase_LANEndpoint.c, we should obtain it.</span>
<a name="l00489"></a>00489     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a71be5890bc11c2285607c8b4770d00ea">systemCreationClassName</a>, 256, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00490"></a>00490 
<a name="l00491"></a>00491     <span class="comment">// SystemName.</span>
<a name="l00492"></a>00492     gethostname(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#ab9c64e84d8e34eef2de9893fd0628af9">systemName</a>, <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#afd80ecbe3170ca4fc85b65cda8659f82">MAXHOSTNAMELEN</a>);
<a name="l00493"></a>00493 
<a name="l00494"></a>00494     <span class="comment">// TransitioningToState.</span>
<a name="l00495"></a>00495     <span class="comment">// @todo implement.</span>
<a name="l00496"></a>00496     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#adcee671f36f8f587fd4ea48186bde364">transitioningToState</a> = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a305fd2b1a221f387eadcd591dde2f479">LEP_RS_UNKNOWN</a>;
<a name="l00497"></a>00497 
<a name="l00498"></a>00498     <span class="comment">// InstallDate.</span>
<a name="l00499"></a>00499     <span class="comment">// @todo implement. how can obtain installation date form a device?</span>
<a name="l00500"></a>00500     <span class="comment">// snprintf(lanEP-&gt;installDate, 64, &quot;%s&quot;, );</span>
<a name="l00501"></a>00501 
<a name="l00502"></a>00502     <span class="comment">// TimeOfLastStateChange.</span>
<a name="l00503"></a>00503     <span class="comment">// @todo implement. How can obtain device last change?.</span>
<a name="l00504"></a>00504     <span class="comment">// snprintf(lanEP-&gt;timeOfLastStateChange, 64, &quot;%s&quot;, );</span>
<a name="l00505"></a>00505 
<a name="l00506"></a>00506     <span class="comment">// StatusDescriptions.</span>
<a name="l00507"></a>00507     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a575445a261f8e7e135285a85d8263ee2">statusDescriptions</a>, 256, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     <span class="comment">// GroupAddresses.</span>
<a name="l00510"></a>00510     <span class="comment">// @todo implement (use CTRL_ATTR_MCAST_GROUPS).</span>
<a name="l00511"></a>00511     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a6aaad4baebd4dfe5c0fc50f4dc89655d">groupAddresses</a>, 32, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00512"></a>00512 
<a name="l00513"></a>00513     <span class="comment">// AliasAddresses.</span>
<a name="l00514"></a>00514     <span class="comment">// @todo implement. Is this supported on linux?</span>
<a name="l00515"></a>00515     snprintf(lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a6e449a03fbae5586b7160c04823501fc">aliasAddresses</a>, 32, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     <span class="comment">// AvailableRequestedStates.</span>
<a name="l00518"></a>00518     <span class="comment">// @todo implement CIM_EnabledLogicalElementCapabilities.</span>
<a name="l00519"></a>00519     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a5a2be46ec1bec0e3aadd7ad393df3860">availReqStates</a>[0] = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a1f5090a2c36ad9e248c2f2462ca6b81d">LEP_RS_ENABLED</a>;
<a name="l00520"></a>00520     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a5a2be46ec1bec0e3aadd7ad393df3860">availReqStates</a>[1] = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a51474f9c38cf7486103c2d7aa0518bbd">LEP_RS_DISABLED</a>;
<a name="l00521"></a>00521     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a5a2be46ec1bec0e3aadd7ad393df3860">availReqStates</a>[2] = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a92c8ceb4b316e95e7519eb0bad4a0aaa">LEP_RS_SHUT_DOWN</a>;
<a name="l00522"></a>00522     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a5a2be46ec1bec0e3aadd7ad393df3860">availReqStates</a>[3] = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a3d436eadd639331719c7d767c4f9bac4">LEP_RS_OFFLINE</a>;
<a name="l00523"></a>00523     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a5a2be46ec1bec0e3aadd7ad393df3860">availReqStates</a>[4] = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a15569ea352d602e975551a48840bd851">LEP_RS_TEST</a>;
<a name="l00524"></a>00524     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a5a2be46ec1bec0e3aadd7ad393df3860">availReqStates</a>[5] = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a73863b380241373c7566ef4648210e7b">LEP_RS_DEFERRED</a>;
<a name="l00525"></a>00525     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a5a2be46ec1bec0e3aadd7ad393df3860">availReqStates</a>[6] = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04acd549d13e2f75a8e6d5d5bc7ae841b98">LEP_RS_QUIESCE</a>;
<a name="l00526"></a>00526     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a5a2be46ec1bec0e3aadd7ad393df3860">availReqStates</a>[7] = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a7fcbffbc1268a826e153493439a70997">LEP_RS_REBOOT</a>;
<a name="l00527"></a>00527     lanEP-&gt;<a class="code" href="struct_l_a_n_endpoint.html#a5a2be46ec1bec0e3aadd7ad393df3860">availReqStates</a>[8] = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#abc6126af1d45847bc59afa0aa3216b04a78e7c276617ae1c05239db9edf5af25e">LEP_RS_RESET</a>;
<a name="l00528"></a>00528 
<a name="l00529"></a>00529  out:
<a name="l00530"></a>00530     _OSBASE_TRACE(3, (<span class="stringliteral">&quot;--- nlInfoTOLanEP() exited&quot;</span>));
<a name="l00531"></a>00531     <span class="keywordflow">return</span> rc;
<a name="l00532"></a>00532 }
<a name="l00533"></a>00533 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00534"></a>00534 
<a name="l00535"></a>00535 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00536"></a><a class="code" href="_o_s_base___l_a_n_endpoint_8c.html#a0ff3f1739478cd89305b5dbb5240aaad">00536</a> <span class="keywordtype">int</span> <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a0ff3f1739478cd89305b5dbb5240aaad">freeLANEndpointList</a>(<span class="keyword">struct</span> <a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> *lptr)
<a name="l00537"></a>00537 {
<a name="l00538"></a>00538     _OSBASE_TRACE(3,(<span class="stringliteral">&quot;--- freeLANEndpointList() called&quot;</span>));
<a name="l00539"></a>00539 
<a name="l00540"></a>00540     <span class="keyword">struct </span><a class="code" href="struct_l_a_n_endpoint_list.html">LANEndpointList</a> *ls = NULL;   <span class="comment">// Temporary list container.</span>
<a name="l00541"></a>00541     <span class="keywordtype">int</span>                     rc = <a class="code" href="_o_s_base___l_a_n_endpoint_8h.html#a74e6ec358f512d509115db0833ec5518">LEP_OK</a>; <span class="comment">// Result handler.</span>
<a name="l00542"></a>00542 
<a name="l00543"></a>00543     <span class="comment">// Check received parameters.</span>
<a name="l00544"></a>00544     <span class="keywordflow">if</span>(lptr == NULL) {
<a name="l00545"></a>00545         _OSBASE_TRACE(2, (<span class="stringliteral">&quot;[INFO] - NULL LANEndpoints list, nothing to free.&quot;</span>));
<a name="l00546"></a>00546         <span class="keywordflow">goto</span> out;
<a name="l00547"></a>00547     }
<a name="l00548"></a>00548 
<a name="l00549"></a>00549     <span class="comment">// Clean.</span>
<a name="l00550"></a>00550     <span class="keywordflow">while</span>(lptr != NULL) {
<a name="l00551"></a>00551         <a class="code" href="_o_s_base___netlink_8h.html#a5a8431d964a3eb0bc6ec073a4d90a651">FREE_SAFE</a>(lptr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#af99ab40e5865144db7deae544ce8ddaf">sptr</a>);
<a name="l00552"></a>00552         ls = lptr;
<a name="l00553"></a>00553         lptr = lptr-&gt;<a class="code" href="struct_l_a_n_endpoint_list.html#a73dddd0fd4134de1e21beaba4329d0ac">next</a>;
<a name="l00554"></a>00554         <a class="code" href="_o_s_base___netlink_8h.html#a5a8431d964a3eb0bc6ec073a4d90a651">FREE_SAFE</a>(ls);
<a name="l00555"></a>00555     }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557  out:
<a name="l00558"></a>00558     _OSBASE_TRACE(3,(<span class="stringliteral">&quot;--- freeLANEndpointList() exited&quot;</span>));
<a name="l00559"></a>00559     <span class="keywordflow">return</span> rc;
<a name="l00560"></a>00560 }
<a name="l00561"></a>00561 <span class="comment">//------------------------------------------------------------------------------</span>
<a name="l00562"></a>00562 
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 20 Mar 2010 for cmpi-router by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
